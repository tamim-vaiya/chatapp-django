{% extends "base.html" %}

{% block body %}
    {{ chatroom.name }}
    <form method="POST">
        {% csrf_token %}
        <input type="text" name="message" placeholder="Enter message...">
        <button type="submit">Send</button>
    </form>
    {{ chatroom.slug|json_script:"json-chatroomname"}}
    <script>
        const chatRoomName = JSON.parse(document.getElementById('json-chatroomname').textContent)
        const chatSocket = new WebSocket(
            'ws://'
            +window.location.host
            +'/ws/'
            +chatRoomName
            +'/'
        )
        chatSocket.onmessage = function(e){
            console.log('this is a message')
        }
        chatSocket.onclose = function(e){
            console.log('Socket closed')
        }
    </script>
{% endblock body %}